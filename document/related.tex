\ifx\mainfile\undefined
\input{chapter_head}
\setcounter{chapter}{8} % Set to n-1!
\fi
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\cleardoublepage
\chapter{Related Work}
\label{chap:related}

In this chapter, I place my thesis in the context of existing work on wireless technology and wireless systems. I view my research as lying at the intersection of three bodies of work: (1) understanding real 802.11 wireless channels, (2) theoretical analysis of wireless link performance, and (3) practical algorithms for configuring wireless systems. I use this framework to guide the discussion of related work.
%I conclude the chapter by discussing the next steps for deploying wireless systems with Effective SNR.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Understanding Real 802.11 Wireless Channels}
Since the advent of Wi-Fi technology in the late 1990s, a number of studies have investigated the performance characteristics of 802.11, and uncovered several issues.

Initial studies of 802.11b in Roofnet~\cite{Aguayo_Roofnet} and at the University of Washington~\cite{Reis_interference} found Packet SNR calculated from RSSI to be a weak predictor of packet delivery. Similar results were observed for sensor networks~\cite{Zhao_sensys03}. One reason for this disconnect was poor calibration of NICs, which has since improved. Today's NICs have calibration procedures that include in-factory measurements of the raw silicon manufacturing variability and on-line measurements conducted when in active use (e.g.\ as described in Chen and Hsieh~\cite{Chen_IQcalib}) to compensate for thermal conditions and power supply effects. As an example, Intel's open-source drivers~\cite{iwlwifi} perform seven calibration steps whenever the device powers on, changes transmit power level, or switches channels to ensure accurate operation of components such as baseband and RF oscillators, and linear transmit amplifiers. Broadcom advertises that its Wi-Fi solutions ``are capable of self-calibrating based on usage temperature and other environmental conditions''~\cite{Broadcom_calib}. These modern calibration solutions have largely overcome these inaccuracies.

Another reason that Packet SNR was observed not to predict performance well for 802.11b was the corruption of RSSI estimates by interference~\cite{Reis_interference,Vlavianos_metrics}. This effect is caused by the spread-spectrum technologies of 802.11b, and the OFDM and MIMO techniques used in 802.11a/g/n today reduce this effect greatly.

Despite these two improvements, a fundamental reason for variation across links with 802.11a/g/n OFDM comes from frequency-selective fading, which does not affect spread-spectrum modulations in 802.11b. These effects have been noticed in several studies of real hardware from a variety of manufacturers~\cite{Han_errors,Miu_MRD} and system analyses~\cite{Lampe_adaptation,Tse}. I present experimental measurements confirming these effects in \chapref{chap:problem} and \chapref{chap:delivery}.

An early 802.11n study by Shrivastava et al.~\cite{Shrivastava_80211n} found that the use of multiple antennas can improve physical layer performance for real hardware. My measurements and model provide a better understanding of the channel that can explain the underlying cause of these gains as well as quantify their potential benefits.

Finally, understanding and developing models for real 802.11 channels is a large part of the 802.11 standards working group. Its members have studied raw channel performance in a variety of environments and mobility conditions and developed models that capture these results, now included as part of the IEEE 802.11-2007~\cite{80211} and IEEE 802.11n-2009 standards~\cite{80211n}. My channel state information measurement tool has been used by 802.11 working group members to inform these models, as well as to provide corrective amendments~\cite{Perahia_Doppler}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Theoretical Analysis of Channel Metrics}
In the face of fading effects that affect real wireless channels, there has been a large body of theoretical work on the performance of systems in these environments.

The 2008 study by Vlavianos et al.~\cite{Vlavianos_metrics} of metrics for devices that operate in real wireless channels uncovered problems with all metrics accessible in Wi-Fi cards at the time. My work fills this gap by both building a practical tool that exposes better physical layer information and developing a practical methodology to compute an accurate channel metric.

Nanda and Rege proposed the Effective SNR~\cite{Nanda_EffectiveSNR} in 1998 as a way of capturing performance over generic faded channels, of which OFDM in 802.11a/g and MIMO-OFDM in 802.11n are instances. Other estimates for faded channels, such as the subcarrier variance proposed by Lampe et al.~\cite{Lampe_adaptation}, may be slightly simpler to compute but are less accurate. As such, the Effective SNR notion has been adopted by many communities and is the basis of the theoretical model in my thesis.

Most work on OFDM with convolutional coding (as in 802.11a/g) begins with the Effective SNR or Effective BER and and adds simulated faded channels to build closed-form expressions for error rates under coding~\cite{Awoniyi_ofdm,Nortel_3g,Tralli_convolutional}. My model is related, but simpler: I avoid simulating complex, implementation-dependent coding effects in favor of using fixed, per-rate thresholds. In prior models, dealing with a different implementation or a different code meant changing the internals of the computation. My model can naturally extend to handle different implementations via an adjustment of thresholds.

Effective SNR and related metrics such as the Mutual Information Effective SNR Metric (MIESM)~\cite{He_MIESM,Liu_EESM,Kant_FLA,Jensen_FLA,Martorell_11n} have also been extended to MIMO-OFDM. These extensions have been evaluated using simulated channel models for technologies like 802.11n or LTE/WiMAX, and focused on designing a metric that is tuned to closely predict simulated delivery, independent of complexity. My model is related to these, but more practical. My model uses simpler internals, and I convert CSI to Effective SNR in a way that better matches the equal modulation and power allocation used by 802.11n and offers a better API for practical use.

Most importantly, I experimentally evaluate my model at the application level for real 802.11 NICs and RF channels; I am not aware of other work that uses Effective SNR measures for Wi-Fi outside of simulation or analysis. My studies of Effective SNR in real channels led me to design my model to account for important artifacts such as quantization error and to include a better understanding of protocol and implementation concerns.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Wireless Network Configuration Algorithms}
I evaluated my Effective SNR model for packet delivery in the context of a variety of 802.11n applications. Each of these applications has a history of application-specific algorithmic implementations, which I discuss here. The key contribution of my thesis is to replace each of these application-specific algorithms with a single unified algorithm that is simple and accurate.

\subsection{Rate adaptation}
The problem of efficiently finding a good rate configuration for wireless networks is a well-studied one, since a good rate selection algorithm is necessary to do anything else with wireless technology.

The rate control algorithms in use today use a form of guided search to adapt rates based on packet delivery statistics. Lucent's ARF algorithm~\cite{Kamerman_ARF}, OAR~\cite{Sadeghi_OAR}, and SampleRate~\cite{Bicket_SampleRate} were early rate adaptation algorithms of this type. RRAA~\cite{Wong_RRAA} enhances these by dynamically enabling or disabling the RTS/CTS mechanism depending on whether hidden terminals are a problem.

The state of the art in rate adaptation based on packet delivery is the Linux kernel's minstrel~\cite{minstrel}, a version of SampleRate/RRAA adapted for modern Wi-Fi hardware that can use lower rates for packet retransmissions. The minstrel algorithm has also been adapted for 802.11n~\cite{minstrel_ht}, performing parallel searches between the multiple MIMO modes with different numbers of spatial streams and channel bandwidths. MiRA~\cite{Pefkianakis_MiRA} is a research algorithm that takes a similar approach. These guided search approaches work well for slowly varying channels and simple configurations (e.g., a few rates with fixed transmit power and channel).

For rapidly varying channels, these algorithms become less effective. Camp et al.~\cite{Camp_rateadapt} demonstrated the importance of varying the time constants used to generate summary statistics for minstrel-like algorithms. Recently, RapidSample~\cite{Ravindranath_SensorHints} used hints from smartphone sensors to detect mobility and switch to a simplified SampleRate-like algorithm that walks up and down the rates in an agile manner. This provides better performance when devices are moving, but it is not obvious how to extend RapidSample's logic to 802.11n where there is not a single linear set of rates. Still, I believe this is a promising direction.

Some research algorithms propose to use Packet SNR based on RSSI to adapt to rapidly varying channels. RBAR~\cite{Holland_RBAR} was an early algorithm that aimed to select transmission rate by measuring SNR at the receiver on the RTS packet, and feeding back a choice of rate based on precomputed SNR thresholds in the CTS response. This type of exchange forms the basis of the feedback algorithms now implemented in the 802.11n standard. In the above mentioned work, Camp et al. used knowledge of device speed to more accurately adapt these SNR thresholds. The hybrid rate control work by Hartcherev et al.~\cite{Haratcherev_Hybrid}, the SGRA~\cite{Zhang_SNRguided} algorithm, and the CHARM~\cite{Judd_CHARM} algorithms all attempted to train the SNR thresholds of a link on-line, and use these learned thresholds to inform delivery-based adaptation when SNR changed suddenly. My Effective SNR can fit into the frameworks of these algorithm types, but it provides a more accurate indicator of performance and does not need on-line training to work for a specific wireless channel.

HYDRA~\cite{Kim_Hydra} used software radios to experimentally evaluate various ARF- and RBAR-inspired variants of rate adaptation for 802.11n over emulated and real wireless channels. However, they used narrow 2\MHz channels and only two transmit antennas, so their results fail to capture the frequency- and spatially-selective nature of real wireless channels that my experimental data and evaluation have shown are important in practice.

Recent work has returned to the theoretical approach and made headway by measuring symbol-level details of packet reception. In particular, SoftRate uses the output of soft-Viterbi decoding for each symbol to estimate the Effective BER~\cite{Vutukuru_SoftRate}. This allows it to predict the effects on packet delivery of changing the rate. AccuRate uses symbol error vectors and a full channel simulator for the same purpose~\cite{Sen_AccuRate}. Error Estimating Coding~\cite{Chen_EEC} accomplishes the same goal by changing or supplementing the link-layer coding scheme. Though they obtain accurate Effective BER estimates, these methods are not defined for selecting other useful parameters, such as transmit power, and they do not extend from 802.11a/g to 802.11n, e.g., when selecting antennas or numbers of spatial streams.

Compared to all of these approaches, my Effective SNR metric is simple, accurate and quick, providing competitive or better performance in static and mobile channels. It is also more general: with a single CSI measurement, I can extrapolate performance in a wide space of rates, spatial streams, antenna selections, channel widths, and transmit power levels. I have also shown that Effective SNR can be implemented on commodity NICs, and I evaluated it over real wireless channels with mobile and fixed clients. My deeper understanding of fading should also aid attempts to use the faster OFDM rates in challenging outdoor mobile environments~\cite{Eriksson_Cabernet} that have previously been hampered by an inability to explain or predict performance in a reasonable way.

Finally, some proposals obtain better performance by changing the physical layer. FARA~\cite{Rahul_FARA} drastically changes the fundamentals of the communication to modulate and code data differently to adapt to each subchannel's best performance. This is not compatible with practical distributed schemes like 802.11 that require that each packet can be demodulated in isolation, and this approach currently requires custom hardware~\cite{Rahul_SWIFT}. Other proposals designed to better integrate with 802.11 combine transmission with more efficient channel-dependent coding~\cite{Lin_ZipTX}, frequency-aware interleaving~\cite{Bhartia_FreqDiv} or partially-correct ARQ schemes~\cite{Jamieson_PPR}. I believe the better estimate of overall error given by the Effective SNR and the understanding of where errors come from given by the CSI can enhance all these schemes.

\subsection{Transmit power control}
Work on transmit power control falls into two main categories: saving energy and increasing spatial reuse (or both). PCMA~\cite{Monks_PowerMAC} increased network capacity by a factor of two in simulated dense networks using a distributed transmit power reduction protocol. MiSer~\cite{Qiao_MiSer} focused on maximizing data-per-Joule and was able to increase this metric by 20\% in simulated 802.11a networks. Son et al.~\cite{Son_PowerStudy} performed practical power control work in single-rate sensor networks. Symphony~\cite{Ramachandran_Symphony} is a recent, more practical work that was experimentally evaluated in an indoor 802.11a network using multiple rates and multiple channels. It used a synchronous, two-phase rate adaptation and power adaptation protocol to reduce transmit power by 3\dB and increase network-wide throughput by 50\%. These are a few representative samples of a wide body of work.

Finally, all these proposals for transmit power control require complex probing and adaptation mechanisms. Several of these studies noted that they had to measure performance at each different power level because it was hard to predict the impact of a power change, even knowing the best rate in the current state. To yield practical protocols, they also assume symmetric channels. This does not match reality in 802.11n networks which have fundamentally asymmetric transmit and receive behavior, such as receiver spatial diversity. My Effective SNR model can overcome both these deficiencies by being able to extrapolate the effects of power control with lightweight measurements that can capture the effects of asymmetric channels. The example evaluation in \chapref{chap:delivery} suggests that, because of a good predictive model, we can use the Effective SNR to directly and confidently select a reduced transmit power without degrading link performance.

\subsection{Antenna selection}
Antenna selection algorithms have long been available and are well-studied~\cite{Tse}. Some 802.11a/g devices such as the Intel IPW3945 and similar chipsets from Atheros and Broadcom include multiple antennas but only a single transmit/receive chain. In these forms, the NICs would simply choose to receive from the antenna with the strongest RSSI, and would also use this antenna to transmit packets~\cite{Broadcom_MIMOChip,Cheng_AntSel}. More advanced techniques took subchannel fading into account~\cite{Zhang_AntSel}.

However, in indoor 802.11a/g systems, these techniques usually provided little gain because switching antennas did not alleviate the primary problem of frequency-selective fading---my evaluation also confirms this result. In contrast, another experiment used RSSI-based antenna selection between multiple differently-polarized antennas for an 802.11 ground link to an unmanned aerial vehicle. In this highly dynamic scenario, the authors found that antenna selection provided almost 70\% throughput improvement~\cite{Vlah_UAV}, suggesting that these techniques may have increased benefit as wireless is used in more dynamic environments.

Modern multi-antenna techniques make these algorithms more interesting. For instance, a battery-operated client may want to disable excess receive antennas to save power; the 802.11n standard~\cite{80211n} introduces a new Spatial Multiplexing Power Save mode for this purpose. It also includes an antenna selection feedback protocol to help link endpoints negotiate antenna use. However, these optional protocols are generally unimplemented; instead, the algorithms in use today remain based on extensive probing. For example, the rate control algorithm implemented in Intel's 802.11n wireless drivers~\cite{iwlwifi} contains two concurrent adaptation loops. One is the standard rate adaptation loop that probes different numbers of streams: SIMO, MIMO2, and MIMO3. The second loop switches between antenna sets within a mode, for instance using antenna pairs AB, AC, and BC to alternately send the two-stream MIMO2 packets. Antenna selection thus enlarges the state space, exacerbating the configuration problem and slowing down the convergence time of these adaptation algorithms. The Effective SNR model I present can cut through this joint configuration space and directly choose a good operating point.

\subsection{Access point selection}
Most existing work on access point selection focuses on other aspects than raw link bitrate, because other factors such as AP load and wired nework performance can matter more in practice~\cite{Balachandran_AP,Judd_AP}. Proposed systems modify clients, access points, or both~\cite{Balachandran_AP,Berjerano_AP,Nicholson_AP,Vasudevan_AP} to probe and/or estimate these factors and to better balance load. Recent state-of-the-art enterprise systems such as DenseAP~\cite{Murty_DenseAP} achieve load balancing by (1) centrally calculating the best potential access point for the client based on triangulation and measurements from the client's probe requests, and then (2) forcing the client to associate there by only letting that AP send a probe response.

My work with Effective SNR is complementary to these techniques. Though these algorithms focus on load balancing, they often include a component that requires estimation of the channel between the client and the AP; my evaluation showed that the use of Effective SNR will improve this step. Secondly, these procedures have not been updated for the multi-antenna techniques used in 802.11n, in which these predictions will need to be made across heterogeneous APs and for asymmetric links. Effective SNR can transparently adapt to these scenarios, while the existing Packet SNR-based procedures do not handle these steps.

\subsection{Channel selection}
Like AP selection, most channel selection work focuses on load balancing between contending links and networks. Rather than estimating the achievable rate between two devices, these algorithms (e.g.,~\cite{Akella_Chan,Athanasiou_LAC,Kauffmann_Chan,Rozner_Chan}) probe the free airtime on the available channels because that is a large contributor to actual throughput. They then organize, in a distributed or centralized manner, either the local or global set of access points across channels to make efficient use of available mechanisms.

Again, Effective SNR complements this work by providing a simple, accurate, quickly measurable link performance estimator that can be plugged as a subroutine into algorithms of this type. My model can also be used in new emerging peer-to-peer wireless scenarios as envisioned in MultiNet~\cite{Chandra_MultiNet} and SampleWidth~\cite{Chandra_SampleWidth}, and instantiated today in Wi-Fi Direct~\cite{wifi_direct}.

\subsection{Multihop networks}
Research on multihop routing is typically framed in the context of mesh networks, and it focuses on maintaining an efficient distributed routing infrastructure~(e.g., \cite{Athanasiou_Mesh,RFC_AODV,Draves_ETT,Rozner_SOAR}). The IEEE standardized the 802.11s amendment in 2011~\cite{80211s} to support mesh networking, using a protocol called hybrid wireless mesh protocol (HWMP) to select paths. The default link metric in HWMP is close to the idealized ETT~\cite{Draves_ETT} metric I used but includes more accounting for overhead. As with ETT, computing this metric requires knowing the wireless bitrate and the packet reception rate, both of which the Effective SNR can predict accurately and quickly.

Other research on multihop networks focuses on pipelining transfers along long mesh paths~\cite{Li_BlockSwitched,Li_Mesh,Rodrig_thesis}, using network coding to improve performance of crossing flows~\cite{Katti_ANC,Katti_XORs,Ni_CodingRates}, or propagating data more effectively across the network by making use of many unreliable links~\cite{Biswas_ExOR}.

As a result of the complex nature of these solutions, work on mesh networks tends to simplify other aspects of network design, for instance by using homogenous single-antenna nodes and fixing the entire network to a single bitrate and uniform transmit power, so that they only have to probe packet delivery at a single rate. For the example case of network coding, one recent extension added the ability to choose between only two 802.11b rates~\cite{Ni_CodingRates}, handling only the state of Wi-Fi in 1997 without many rates, OFDM, and MIMO. Another proposed a distributed probing framework to handle concurrent rate adaptation, evaluated it using simulation only~\cite{Kim_NetworkCoding}. Incorporating my Effective SNR model would simplify the channel estimation components of these schemes and enable them to handle the broad configuration space posed in heterogenous MIMO and OFDM networks.

\section{Follow-on research}
Other authors have used my CSI measurement tool and Effective SNR models for applications that go beyond the ones described in this thesis. I describe these projects here because they are related to the work in my thesis. They highlight the value to the community of refining and releasing my research prototype~\cite{Halperin_csitool}.

My CSI measurement tool has been used independently of my Effective SNR model in several projects. Researchers at Duke University and the Hong Kong University of Science and Technology have built three systems~\cite{Sen_PinLoc,Sen_SpinLoc,Wu_FILA} that use CSI information for indoor localization. Researchers at Intel Corporation and at Carnegie Mellon University have incorporated measurements taken with my prototype into their work on building accurate models of wireless channels~\cite{Perahia_Doppler} and better emulating them (in the emulator by Judd et al.~\cite{CMU_Emulator,Judd_Emulator}). In the context of improving rates, a group at the University of Texas at Austin used CSI measurements to design techniques that better take advantage of frequency diversity~\cite{Bhartia_FreqDiv}.

My Effective SNR model has been used in two ways. First, it has been adopted as the rate selection algorithm in recent projects that use software radios to conduct research on 802.11n~\cite{Lin_80211n+}, as these platforms enable the necessary CSI to be exposed. Second, in the area of better handling the block-oriented nature of 802.11e/802.11n protocols with packet batching~\cite{Tie_BlockRate}, researchers have used my Effective SNR model to forecast better predictions of future bitrates in highly mobile wireless channels~\cite{Sen_PhyRate}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\ifx\mainfile\undefined
\input{chapter_tail}
\fi
